<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="login.css">
</head>

<body>
  <form class="form" id="myForm">
    <p class="form-title">Sign in to your account</p>
    <div class="input-container">
      <input id="username" type="email" placeholder="Enter email">
      <span>
      </span>
    </div>

    <div class="input-container">
      <input id="password" type="password" placeholder="Enter password">
    </div>
    <button class="submit">
      Sign in
    </button>

    <p class="signup-link">
      Don't have an account?
      <a href="signup.html">Sign up</a>
    </p>
  </form>
  <script>
    // Login Client Logic
    const form = document.getElementById('myForm');
    const password = document.getElementById('password')
    const username = document.getElementById('username')

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      console.log("Submitted")
      postLoginData()
    });

    const postLoginData = async () => {
      const userData = {
        username: username.value,
        password: password.value,
      }

      try {
        const response = await fetch('http://localhost:3000/login', {
          method: "POST",
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(userData)
        })

        const data = await response.json()
        if (response.ok) {
          console.log(data)
          window.location = 'index.html'
        }
        else {
          alert("Invalid Credentials")
        }
      } catch (error) {
        console.log(error)
      }
    }

    console.log("first")
  </script>
</body>

</html>